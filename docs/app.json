[{"name":"app.R","content":"library(shiny)\r\nlibrary(DT)\r\nlibrary(shinythemes)\r\n\r\nui <- fluidPage(\r\n  theme = shinytheme(\"flatly\"),\r\n  titlePanel(\"Gestão de Pacientes e Cálculo de IMC\"),\r\n  \r\n  column(12, \r\n         p(\"Preencha os dados e clique em Adicionar. Para remover registros, selecione as linhas na tabela e clique em 'Apagar Linha(s)'. \",\r\n           \"Você também pode exportar os dados (Excel ou PDF) ou copiá-los para a área de transferência usando os botões acima da tabela.\")\r\n  ),\r\n  \r\n  hr(),\r\n  \r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      wellPanel(\r\n        h4(\"Cadastro\"),\r\n        textInput(\"nome\", \"Nome:\"),\r\n        numericInput(\"altura\", \"Altura (m):\", 1.70, 0.5, step = 0.01),\r\n        numericInput(\"peso\", \"Peso (kg):\", 70, 1, step = 0.1),\r\n        actionButton(\"add\", \"Adicionar Paciente\", class = \"btn-primary\", width = \"100%\", icon = icon(\"plus\"))\r\n      )\r\n    ),\r\n    \r\n    mainPanel(\r\n      div(style = \"display: flex; justify-content: space-between; align-items: center;\",\r\n          h4(\"Lista de Pacientes\"),\r\n          # Botão de apagar (só aparece se houver seleção)\r\n          uiOutput(\"botao_deletar_ui\")\r\n      ),\r\n      DTOutput(\"tabela_pacientes\")\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # Banco de dados reativo\r\n  dados_pacientes <- reactiveVal(data.frame(\r\n    Nome = character(),\r\n    Altura = numeric(),\r\n    Peso = numeric(),\r\n    IMC = numeric(),\r\n    Status = character(),\r\n    stringsAsFactors = FALSE\r\n  ))\r\n  \r\n  # Adicionar paciente\r\n  observeEvent(input$add, {\r\n    if (input$nome == \"\" || is.na(input$altura) || is.na(input$peso)) {\r\n      showNotification(\"Preencha todos os campos.\", type = \"warning\")\r\n      return()\r\n    }\r\n    \r\n    imc_calc <- round(input$peso / (input$altura^2), 2)\r\n    status_imc <- ifelse(imc_calc < 18.5, \"Abaixo do peso\",\r\n                         ifelse(imc_calc < 25, \"Peso normal\",\r\n                                ifelse(imc_calc < 30, \"Sobrepeso\", \"Obesidade\")))\r\n    \r\n    nova_linha <- data.frame(Nome = input$nome, Altura = input$altura, \r\n                             Peso = input$peso, IMC = imc_calc, Status = status_imc)\r\n    \r\n    dados_pacientes(rbind(dados_pacientes(), nova_linha))\r\n    updateTextInput(session, \"nome\", value = \"\")\r\n  })\r\n  \r\n  # Lógica para deletar linhas\r\n  observeEvent(input$delete_rows, {\r\n    ids_selecionados <- input$tabela_pacientes_rows_selected\r\n    if (length(ids_selecionados) > 0) {\r\n      dados_pacientes(dados_pacientes()[-ids_selecionados, ])\r\n    }\r\n  })\r\n  \r\n  # Botão de deletar condicional\r\n  output$botao_deletar_ui <- renderUI({\r\n    if (!is.null(input$tabela_pacientes_rows_selected)) {\r\n      actionButton(\"delete_rows\", \"Apagar Linha(s)\", class = \"btn-danger\", icon = icon(\"trash-alt\"))\r\n    }\r\n  })\r\n  \r\n  # Tabela com Botões de Exportação e Copiar\r\n  output$tabela_pacientes <- renderDT({\r\n    datatable(\r\n      dados_pacientes(),\r\n      selection = 'multiple',\r\n      extensions = 'Buttons',\r\n      options = list(\r\n        dom = 'Bfrtip',\r\n        buttons = list(\r\n          list(extend = 'excel', text = 'Exportar Excel', className = 'btn-success'),\r\n          list(extend = 'pdf', text = 'Exportar PDF'),\r\n          list(extend = 'copy', text = 'Copiar Dados')\r\n        ),\r\n        language = list(url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/Portuguese-Brasil.json')\r\n      )\r\n    )\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)","type":"text"}]
